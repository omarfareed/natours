{"version":3,"sources":["alerts.js","login.js","mapbox.js","updateData.js","stripe.js","index.js"],"names":["hideAlert","el","document","querySelector","remove","showAlert","type","msg","markUp","insertAdjacentHTML","window","setTimeout","login","email","password","axios","console","log","method","url","data","res","status","startsWith","location","assign","logout","reload","response","message","displayMap","locations","mapboxgl","accessToken","map","Map","container","style","bounds","LngLatBounds","forEach","loc","element","createElement","className","Marker","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","left","right","bottom","updateData","stripe","Stripe","bookTour","tourId","fetch","session","json","sessionJSON","sessionId","id","redirectToCheckout","loginForm","userForm","passwordForm","logOutButton","bookBtn","getElementById","mapBox","JSON","parse","dataset","addEventListener","e","preventDefault","value","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target"],"mappings":"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","file":"bundle.js","sourceRoot":"","sourcesContent":["export const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.remove(); //==> el.parentElement.removeChild(el);\n};\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markUp = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markUp);\n  window.setTimeout(hideAlert, 5000);\n};\n","// import axios from './../../node_modules/axios/lib/axios.js';\nimport { showAlert } from './alerts.js';\nexport const login = async (email, password) => {\n  console.log(email, password);\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/users/login',\n      data: {\n        email,\n        password\n      }\n    });\n    if (res.data.status.startsWith('suc')) {\n      showAlert('success', 'logged in successfully');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n    console.log(res);\n  } catch (err) {\n    showAlert('error', err);\n  }\n};\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/users/logout'\n    });\n    if (res.data.status.startsWith('suc')) {\n      showAlert('success', 'logged out successfully');\n      window.setTimeout(() => {\n        location.reload(true);\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n","\nexport const displayMap = locations => {\n  mapboxgl.accessToken =\n    'pk.eyJ1Ijoib21hcmZhcmVlZCIsImEiOiJja3N5ZmN3NzAyajZrMnluMWtsM205ZGM3In0.Q3a4sYSFy2p50nWzReN2xg';\n  // CREATE map\n  var map = new mapboxgl.Map({\n    container: 'map', // ELEMENT ID TO BE PUT IN\n    style: 'mapbox://styles/omarfareed/cksyk2efp0rf717sdl6sxssfp' //YOUR MAP STYLE\n    //   center: [-118.113491, 34.111745],\n    //   zoom : 8\n  });\n  const bounds = new mapboxgl.LngLatBounds();\n  locations.forEach(loc => {\n    const element = document.createElement('div');\n    element.className = 'marker';\n    // ADD MARKER\n    new mapboxgl.Marker({\n      element,\n      anchor: 'bottom'\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n    // ADD popup\n    new mapboxgl.Popup({\n      offset: 30 // 30 px to show both icon and text\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(`<p>Day ${loc.day}: ${loc.description} </p>`)\n      .addTo(map);\n    bounds.extend(loc.coordinates);\n  });\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      left: 200,\n      right: 200,\n      bottom: 200\n    }\n  });\n};\n","import { showAlert } from './alerts.js';\nexport const updateData = async (data, type) => {\n  try {\n    // console.log(email, name);\n    console.log(data);\n    const url = `/api/v1/users/update${\n      type === 'password' ? 'MyPassword' : 'Me'\n    }`;\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data\n    });\n    if (res.data.status.startsWith('suc')) {\n      showAlert('success', 'Updated successfully');\n      // window.setTimeout(() => window.location.reload(true), 1500);\n    }\n  } catch (err) {\n    console.log(err.response);\n    showAlert('error', err.response.data.message);\n  }\n};\n","const stripe = Stripe(\n  'pk_test_51JYRhODix4r2vkMx3Jp8rrWXaOKpo3K6IBMC6kmKC0zbs3swNbklUrr2cr5BQZd2ElNq7jK2mAln6p8RoFD6pYnP00ZUT67RrP'\n);\nexport const bookTour = async tourId => {\n  try {\n    const session = await fetch(\n      `api/v1/bookings/checkout-session/${tourId}`,\n      {\n        method: 'GET'\n      }\n    );\n    const sessionJSON = await session.json();\n    const sessionId = sessionJSON.session.id;\n    await stripe.redirectToCheckout({\n      sessionId\n    });\n  } catch (err) {\n    console.log(err);\n  }\n};\n","// import '@babel/polyfill';\nimport { login, logout } from './login.js';\nimport { displayMap } from './mapbox.js';\nimport { updateData } from './updateData.js';\nimport { bookTour } from './stripe.js';\n// import axios from './../../node_modules/axios/lib/';\n// const {login } = require('./login');\n// const {displayMap} = require('./mapbox');\nconsole.log(axios);\nconst loginForm = document.querySelector('.login-form');\nconst userForm = document.querySelector('.form-user-data');\nconst passwordForm = document.querySelector('.form-user-settings');\nconst logOutButton = document.querySelector('.nav__el--logout');\nconst bookBtn = document.getElementById('book-tour');\nconsole.log(loginForm);\nconst mapBox = document.getElementById('map');\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\nif (loginForm) {\n  console.log('here');\n  loginForm.addEventListener('submit', e => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    console.log(email, password);\n    login(email, password);\n  });\n}\nif (logOutButton) {\n  logOutButton.addEventListener('click', logout);\n}\nuserForm &&\n  userForm.addEventListener('submit', e => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n    console.log(form);\n    // console.log('here');\n    // const name = document.getElementById('name').value;\n    // const email = document.getElementById('email').value;\n    updateData(form, 'data');\n  });\npasswordForm &&\n  passwordForm.addEventListener('submit', e => {\n    e.preventDefault();\n    document.querySelector('.btn--save--password').textContent = 'Updating...';\n    const passwordCurrent = document.getElementById('password-current').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    const password = document.getElementById('password').value;\n    updateData({ password, passwordConfirm, passwordCurrent }, 'password');\n    document.getElementById('password-current').value = document.getElementById(\n      'password-confirm'\n    ).value = document.getElementById('password').value = '';\n    document.querySelector('.btn--save--password').textContent =\n      'Save Password';\n  });\nif (bookBtn)\n  bookBtn.addEventListener('click', async e => {\n    const { tourId } = e.target.dataset;\n    e.target.textContent = 'Processing...';\n    await bookTour(tourId);\n  });\n"]}